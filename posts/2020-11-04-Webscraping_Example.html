<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.336">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>tech_blog - Webscraping Text and Images with BeautifulSoup example</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">tech_blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Webscraping Text and Images with BeautifulSoup example</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>This notebook code is from the app found here: https://github.com/kenichinakanishi/houseplant_classifier/</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> Request, urlopen</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getHTMLContent(link):</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    html <span class="op">=</span> urlopen(link)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> BeautifulSoup(html, <span class="st">'html.parser'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> soup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>req <span class="op">=</span> Request(<span class="st">'https://www.aspca.org/pet-care/animal-poison-control/cats-plant-list'</span>, headers<span class="op">=</span>{<span class="st">'User-Agent'</span>: <span class="st">'Mozilla/5.0'</span>})</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>webpage <span class="op">=</span> urlopen(req).read()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Soupify the webpage</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>soup <span class="op">=</span> BeautifulSoup(webpage, <span class="st">'lxml'</span>)       </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Search through the parse tree to get all the content from the table         </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>content_list <span class="op">=</span> soup.find_all(<span class="st">'span'</span>)[<span class="dv">7</span>:<span class="op">-</span><span class="dv">4</span>]       </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Put it in a dataframe for further processing</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>df_cats <span class="op">=</span> pd.DataFrame(content_list)           </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/gao/anaconda3/lib/python3.7/site-packages/pandas/core/internals/construction.py:305: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  values = np.array([convert(v) for v in values])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up the strings</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df_cats[<span class="dv">0</span>] <span class="op">=</span> df_cats[<span class="dv">0</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x).split(<span class="st">'&gt;'</span>)[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">3</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df_cats[<span class="dv">4</span>] <span class="op">=</span> df_cats[<span class="dv">4</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x).split(<span class="st">'&gt;'</span>)[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">3</span>])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df_cats[<span class="dv">1</span>] <span class="op">=</span> df_cats[<span class="dv">1</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x).split(<span class="st">'('</span>)[<span class="dv">1</span>][<span class="dv">0</span>:<span class="op">-</span><span class="dv">4</span>])</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of useless columns and rename the columns</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>df_cats <span class="op">=</span> df_cats.drop(columns<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>]).rename(columns <span class="op">=</span> {<span class="dv">0</span>:<span class="st">'Name'</span>,<span class="dv">1</span>:<span class="st">'Alternative Names'</span>,<span class="dv">4</span>:<span class="st">'Scientific Name'</span>,<span class="dv">7</span>:<span class="st">'Family'</span>})</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate toxic and non-toxic plants</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df_cats[<span class="st">'Toxic to Cats'</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>first_nontoxic_cats <span class="op">=</span> [index <span class="cf">for</span> index <span class="kw">in</span> df_cats[df_cats[<span class="st">'Name'</span>].<span class="bu">str</span>.startswith(<span class="st">'A'</span>)].index <span class="cf">if</span> index<span class="op">&gt;</span><span class="dv">100</span>][<span class="dv">0</span>]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>df_cats.loc[first_nontoxic_cats:,<span class="st">'Toxic to Cats'</span>] <span class="op">=</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_cats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Alternative Names</th>
<th data-quarto-table-cell-role="th">Scientific Name</th>
<th data-quarto-table-cell-role="th">Family</th>
<th data-quarto-table-cell-role="th">Toxic to Cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Adam-and-Eve</td>
<td>Arum, Lord-and-Ladies, Wake Robin, Starch Root...</td>
<td>Arum maculatum</td>
<td>Araceae</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>African Wonder Tree</td>
<td></td>
<td>Ricinus communis</td>
<td></td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Alocasia</td>
<td>Elephant's Ear</td>
<td>Alocasia spp.</td>
<td>Araceae</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Aloe</td>
<td></td>
<td>Aloe vera</td>
<td>Liliaceae</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Amaryllis</td>
<td>Many, including: Belladonna lily, Saint Joseph...</td>
<td>Amaryllis spp.</td>
<td>Amaryllidaceae</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">980</td>
<td>Yellowrocket</td>
<td></td>
<td>Barbarea vulgaris</td>
<td>Brassicaceae</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">981</td>
<td>Yorba Linda</td>
<td></td>
<td>Peperomia rotundifolia</td>
<td>Piperaceae</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">982</td>
<td>Zebra Haworthia</td>
<td></td>
<td>Haworthia fasciata</td>
<td>Liliaceae</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">983</td>
<td>Zinnia</td>
<td></td>
<td>Zinnia species</td>
<td>Asteraceae</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">984</td>
<td>Zucchini Squash</td>
<td></td>
<td>Cucurbia pepo cv zucchini</td>
<td>Cucurbitaceae</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>985 rows Ã— 5 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>req <span class="op">=</span> Request(<span class="st">'https://www.aspca.org/pet-care/animal-poison-control/dogs-plant-list'</span>, headers<span class="op">=</span>{<span class="st">'User-Agent'</span>: <span class="st">'Mozilla/5.0'</span>})</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>webpage <span class="op">=</span> urlopen(req).read()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>soup <span class="op">=</span> BeautifulSoup(webpage, <span class="st">'lxml'</span>)                 <span class="co"># soupify the webpage</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>content_list <span class="op">=</span> soup.find_all(<span class="st">'span'</span>)[<span class="dv">7</span>:<span class="op">-</span><span class="dv">4</span>]            <span class="co"># Get all the content from the table</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>df_dogs <span class="op">=</span> pd.DataFrame(content_list)                  <span class="co"># Put it in a dataframe for processing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/gao/anaconda3/lib/python3.7/site-packages/pandas/core/internals/construction.py:305: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  values = np.array([convert(v) for v in values])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up the strings</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df_dogs[<span class="dv">0</span>] <span class="op">=</span> df_dogs[<span class="dv">0</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x).split(<span class="st">'&gt;'</span>)[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">3</span>])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>df_dogs[<span class="dv">4</span>] <span class="op">=</span> df_dogs[<span class="dv">4</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x).split(<span class="st">'&gt;'</span>)[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">3</span>])</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>df_dogs[<span class="dv">1</span>] <span class="op">=</span> df_dogs[<span class="dv">1</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="bu">str</span>(x).split(<span class="st">'('</span>)[<span class="dv">1</span>][<span class="dv">0</span>:<span class="op">-</span><span class="dv">4</span>])</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of useless columns and rename the columns</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>df_dogs <span class="op">=</span> df_dogs.drop(columns<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>]).rename(columns <span class="op">=</span> {<span class="dv">0</span>:<span class="st">'Name'</span>,<span class="dv">1</span>:<span class="st">'Alternative Names'</span>,<span class="dv">4</span>:<span class="st">'Scientific Name'</span>,<span class="dv">7</span>:<span class="st">'Family'</span>})</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate toxic and non-toxic plants</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>df_dogs[<span class="st">'Toxic to Dogs'</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>first_nontoxic_dogs <span class="op">=</span> [index <span class="cf">for</span> index <span class="kw">in</span> df_dogs[df_dogs[<span class="st">'Name'</span>].<span class="bu">str</span>.startswith(<span class="st">'A'</span>)].index <span class="cf">if</span> index<span class="op">&gt;</span><span class="dv">100</span>][<span class="dv">0</span>]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>df_dogs.loc[first_nontoxic_dogs:,<span class="st">'Toxic to Dogs'</span>] <span class="op">=</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge dataframes into one, outer merge used to retain values that only exist on one side</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_catsdogs <span class="op">=</span> df_dogs.merge(df_cats, how<span class="op">=</span><span class="st">'outer'</span>, on<span class="op">=</span>[<span class="st">'Name'</span>,<span class="st">'Alternative Names'</span>,<span class="st">'Scientific Name'</span>,<span class="st">'Family'</span>])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df_catsdogs <span class="op">=</span> df_catsdogs.fillna(<span class="st">'Unknown'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> df_catsdogs.copy()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume same toxicity for dogs and cats if unknown</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>aspca_df[<span class="st">'Toxic to Cats'</span>] <span class="op">=</span> aspca_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">'Toxic to Dogs'</span>] <span class="cf">if</span> (x[<span class="st">'Toxic to Cats'</span>] <span class="op">==</span> <span class="st">'Unknown'</span>) <span class="cf">else</span> x[<span class="st">'Toxic to Cats'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>aspca_df[<span class="st">'Toxic to Dogs'</span>] <span class="op">=</span> aspca_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">'Toxic to Cats'</span>] <span class="cf">if</span> (x[<span class="st">'Toxic to Dogs'</span>] <span class="op">==</span> <span class="st">'Unknown'</span>) <span class="cf">else</span> x[<span class="st">'Toxic to Dogs'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge dataframes into one, outer merge used to retain values that only exist on one side</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_catsdogs <span class="op">=</span> df_dogs.merge(df_cats, how<span class="op">=</span><span class="st">'outer'</span>, on<span class="op">=</span>[<span class="st">'Name'</span>,<span class="st">'Alternative Names'</span>,<span class="st">'Scientific Name'</span>,<span class="st">'Family'</span>])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>df_catsdogs <span class="op">=</span> df_catsdogs.fillna(<span class="st">'Unknown'</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> df_catsdogs.copy()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume same toxicity for dogs and cats if unknown</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>aspca_df[<span class="st">'Toxic to Cats'</span>] <span class="op">=</span> aspca_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">'Toxic to Dogs'</span>] <span class="cf">if</span> (x[<span class="st">'Toxic to Cats'</span>] <span class="op">==</span> <span class="st">'Unknown'</span>) <span class="cf">else</span> x[<span class="st">'Toxic to Cats'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>aspca_df[<span class="st">'Toxic to Dogs'</span>] <span class="op">=</span> aspca_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">'Toxic to Cats'</span>] <span class="cf">if</span> (x[<span class="st">'Toxic to Dogs'</span>] <span class="op">==</span> <span class="st">'Unknown'</span>) <span class="cf">else</span> x[<span class="st">'Toxic to Dogs'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>aspca_df.sample(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Alternative Names</th>
<th data-quarto-table-cell-role="th">Scientific Name</th>
<th data-quarto-table-cell-role="th">Family</th>
<th data-quarto-table-cell-role="th">Toxic to Dogs</th>
<th data-quarto-table-cell-role="th">Toxic to Cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">810</td>
<td>Pink Splash</td>
<td>Flamingo Plant, Polka Dot Plant, Measles Plant...</td>
<td>Hypoestes phyllostachya</td>
<td>Acanthaceae</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">120</td>
<td>English Ivy</td>
<td>Branching Ivy, Glacier Ivy, Needlepoint Ivy, S...</td>
<td>Hedera helix</td>
<td>Araliaceae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">564</td>
<td>Crape Myrtle</td>
<td>Crepe Myrtle</td>
<td>Lagerstroemia indica</td>
<td>Lythraceae</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">201</td>
<td>Japanese Yew</td>
<td>English Yew, Western Yew, Pacific Yew, Anglo-J...</td>
<td>Taxus sp.</td>
<td>Taxaceae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">635</td>
<td>Giant Touch-Me-Not</td>
<td>Buzzy Lizzie, Impatience Plant, Patient Lucy, ...</td>
<td>Impatiens spp.</td>
<td>Balsaminaceae</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">92</td>
<td>Cowbane</td>
<td>Water Hemlock, Poison Parsnip</td>
<td>Cicuta species</td>
<td>Apiaceae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">277</td>
<td>Ornamental Pepper</td>
<td>Natal Cherry, Winter Cherry, Jerusalem Cherry</td>
<td>Solanum pseudocapsicum</td>
<td>Solanaceae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">513</td>
<td>Carrot Fern</td>
<td></td>
<td>Onychium japonica</td>
<td>Polypodiaceae</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">712</td>
<td>Leather Peperomia</td>
<td></td>
<td>Peperomia crassifolia</td>
<td>Piperaceae</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">493</td>
<td>California Pitcher Plant</td>
<td>Cobra Orchid, Cobra Plant, Cobra Lily, Chrysam...</td>
<td>Darlingtonia californica</td>
<td>Sarraceniaceae</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.drop_duplicates(<span class="st">'Scientific Name'</span>) <span class="co"># Get rid of duplicates</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.reset_index(drop<span class="op">=</span><span class="va">True</span>).sort_index()   <span class="co"># Reset and sort index</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.drop(aspca_df[aspca_df[<span class="st">'Scientific Name'</span>].isin([<span class="st">''</span>,<span class="st">'NONE LISTED'</span>])].index,axis<span class="op">=</span><span class="dv">0</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>).sort_index()    <span class="co"># Fix mistakes in database</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure proper punctuation for each scientific name.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_capitalization(x):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  first_word, rest <span class="op">=</span> x.split()[<span class="dv">0</span>], x.split()[<span class="dv">1</span>:]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  first_word <span class="op">=</span> [first_word.capitalize()]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  rest <span class="op">=</span> [word.lower() <span class="cf">for</span> word <span class="kw">in</span> rest]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="st">' '</span>.join(first_word<span class="op">+</span>rest)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up repeated species that have different names</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> species_normalizer(word):</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> word.split()[<span class="op">-</span><span class="dv">1</span>] <span class="kw">in</span> [<span class="st">'sp'</span>,<span class="st">'species'</span>,<span class="st">'spp'</span>,<span class="st">'sp.'</span>,<span class="st">'spp.'</span>]:</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    word <span class="op">=</span> <span class="st">''</span>.join(word.split()[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> word</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove cv from names, as it is an outdated way of referring to cultivars</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cv_remover(word):</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="st">'cv'</span> <span class="kw">in</span> word:</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    word <span class="op">=</span> word.replace(<span class="st">' cv '</span>,<span class="st">' '</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> word</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove var. from names</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> var_remover(word):</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="st">'var'</span> <span class="kw">in</span> word:</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    word <span class="op">=</span> word.replace(<span class="st">' var. '</span>,<span class="st">' '</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> word</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply each of the functions</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>aspca_df[<span class="st">'Scientific Name'</span>] <span class="op">=</span> aspca_df[<span class="st">'Scientific Name'</span>].<span class="bu">apply</span>(normalize_capitalization)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>aspca_df[<span class="st">'Scientific Name'</span>] <span class="op">=</span> aspca_df[<span class="st">'Scientific Name'</span>].<span class="bu">apply</span>(species_normalizer)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>aspca_df[<span class="st">'Scientific Name'</span>] <span class="op">=</span> aspca_df[<span class="st">'Scientific Name'</span>].<span class="bu">apply</span>(cv_remover)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>aspca_df[<span class="st">'Scientific Name'</span>] <span class="op">=</span> aspca_df[<span class="st">'Scientific Name'</span>].<span class="bu">apply</span>(var_remover)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove special characters</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>aspca_df[<span class="st">'Scientific Name'</span>] <span class="op">=</span> aspca_df[<span class="st">'Scientific Name'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">''</span>.join([character <span class="cf">for</span> character <span class="kw">in</span> x <span class="cf">if</span> character.isalnum() <span class="kw">or</span> character.isspace()]))</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset dataframe for further processing</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.sort_values(<span class="st">'Scientific Name'</span>).drop_duplicates(<span class="st">'Scientific Name'</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.reset_index(drop<span class="op">=</span><span class="va">True</span>).sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>aspca_df.sample(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Alternative Names</th>
<th data-quarto-table-cell-role="th">Scientific Name</th>
<th data-quarto-table-cell-role="th">Family</th>
<th data-quarto-table-cell-role="th">Toxic to Dogs</th>
<th data-quarto-table-cell-role="th">Toxic to Cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">108</td>
<td>American Bittersweet</td>
<td>Bittersweet, Waxwork, Shrubby Bittersweet, Fal...</td>
<td>Celastrus scandens</td>
<td>Celastraceae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">530</td>
<td>Pacific Yew</td>
<td>English Yew, Western Yew, Japanese Yew, Anglo-...</td>
<td>Taxus brevifolia</td>
<td>Taxaceae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">467</td>
<td>Pie Plant</td>
<td>Rhubarb</td>
<td>Rheum rhabarbarium</td>
<td>Polygonaceae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">164</td>
<td>Pheasant Plant</td>
<td>Zebra Plant</td>
<td>Cryptanthus zonatus</td>
<td>Bromeliaceae</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">452</td>
<td>Primrose</td>
<td></td>
<td>Primula vulgaris</td>
<td>Primulaceae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">506</td>
<td>Jackson Brier</td>
<td></td>
<td>Smilax lanceolata</td>
<td>Liliaceae</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">407</td>
<td>Ivy Peperomia</td>
<td>Plantinum Peperomia, Silver leaf Peperomia, Iv...</td>
<td>Peperomia griseoargentea</td>
<td>Piperaceae</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">147</td>
<td>Poison Hemlock</td>
<td>Poison Parsley, Spotted Hemlock, Winter Fern, ...</td>
<td>Conium maculatum</td>
<td>Umbelliferae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">351</td>
<td>Cardinal Flower</td>
<td>Lobelia, Indian Pink</td>
<td>Lobelia cardinalis</td>
<td>Campanulaceae</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">236</td>
<td>Pink Brocade</td>
<td></td>
<td>Episcia cultivar</td>
<td>Gesneriaceae</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>use_cols <span class="op">=</span> [<span class="st">'scientificName'</span>,<span class="st">'taxonRank'</span>,<span class="st">'family'</span>,<span class="st">'genus'</span>,<span class="st">'taxonomicStatus'</span>,<span class="st">'taxonID'</span>, <span class="st">'acceptedNameUsageID'</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>wfo_df <span class="op">=</span> pd.read_csv(<span class="st">'../classification.txt'</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, lineterminator<span class="op">=</span><span class="st">'</span><span class="ch">\n</span><span class="st">'</span>, usecols<span class="op">=</span>use_cols)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>wfo_df <span class="op">=</span> wfo_df.sort_values(<span class="st">'taxonomicStatus'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/gao/.local/lib/python3.7/site-packages/IPython/core/interactiveshell.py:3146: DtypeWarning: Columns (10) have mixed types.Specify dtype option on import or set low_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>wfo_df.sample(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">taxonID</th>
<th data-quarto-table-cell-role="th">scientificName</th>
<th data-quarto-table-cell-role="th">taxonRank</th>
<th data-quarto-table-cell-role="th">family</th>
<th data-quarto-table-cell-role="th">genus</th>
<th data-quarto-table-cell-role="th">taxonomicStatus</th>
<th data-quarto-table-cell-role="th">acceptedNameUsageID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">796160</td>
<td>wfo-0000798814</td>
<td>Peridium oblongifolium</td>
<td>SPECIES</td>
<td>Peraceae</td>
<td>Peridium</td>
<td>Synonym</td>
<td>wfo-0000267144</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">180708</td>
<td>wfo-0000180970</td>
<td>Cracca smallii</td>
<td>SPECIES</td>
<td>Fabaceae</td>
<td>Cracca</td>
<td>Synonym</td>
<td>wfo-0000178756</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">911945</td>
<td>wfo-0000914633</td>
<td>Thinopyrum turcicum</td>
<td>SPECIES</td>
<td>Poaceae</td>
<td>Thinopyrum</td>
<td>Synonym</td>
<td>wfo-0000866236</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">167159</td>
<td>wfo-0000167369</td>
<td>Indigofera cinerea</td>
<td>SPECIES</td>
<td>Fabaceae</td>
<td>Indigofera</td>
<td>Synonym</td>
<td>wfo-0000173646</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">642316</td>
<td>wfo-0000644639</td>
<td>Diaphanoptera khorasanica</td>
<td>SPECIES</td>
<td>Caryophyllaceae</td>
<td>Diaphanoptera</td>
<td>Accepted</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">464965</td>
<td>wfo-0000466716</td>
<td>Phyllocyclus minutiflorus</td>
<td>SPECIES</td>
<td>Gentianaceae</td>
<td>Phyllocyclus</td>
<td>Doubtful</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">740337</td>
<td>wfo-0000742945</td>
<td>Daphne pseudomezereum var. koreana</td>
<td>VARIETY</td>
<td>Thymelaeaceae</td>
<td>Daphne</td>
<td>Synonym</td>
<td>wfo-0000637684</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">868404</td>
<td>wfo-0000871073</td>
<td>Festuca montis-aurei</td>
<td>SPECIES</td>
<td>Poaceae</td>
<td>Festuca</td>
<td>Synonym</td>
<td>wfo-0000869683</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">186218</td>
<td>wfo-0000186502</td>
<td>Lotononis curvicarpa</td>
<td>SPECIES</td>
<td>Fabaceae</td>
<td>Lotononis</td>
<td>Accepted</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">552490</td>
<td>wfo-0000554468</td>
<td>Specklinia casualis</td>
<td>SPECIES</td>
<td>Orchidaceae</td>
<td>Specklinia</td>
<td>Synonym</td>
<td>wfo-0000339564</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't need this column, we trust the WFO database more</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>aspca_df.drop(<span class="st">'Family'</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge dataframes together to get trusted info</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.merge(wfo_df, how <span class="op">=</span> <span class="st">'left'</span>, left_on <span class="op">=</span> [<span class="st">'Scientific Name'</span>], right_on <span class="op">=</span> [<span class="st">'scientificName'</span>])</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by taxonomicStatus and drop duplicates keeping the first - keeping accepted names as priority</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.sort_values(<span class="st">'taxonomicStatus'</span>).drop_duplicates(<span class="st">'Scientific Name'</span>, keep<span class="op">=</span><span class="st">'first'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NaN's with Unknown</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.fillna(<span class="st">'Unknown'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up and deal with scientific names that are unknown, due to misspellings or otherwise.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.sort_values(<span class="st">'taxonomicStatus'</span>).drop_duplicates(<span class="st">'Scientific Name'</span>, keep<span class="op">=</span><span class="st">'first'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>unknown_idx <span class="op">=</span> aspca_df[aspca_df.taxonomicStatus <span class="op">==</span> <span class="st">'Unknown'</span>].index</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(unknown_idx))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>101</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_closest_name(unknown_name, name_df <span class="op">=</span> wfo_df, name_col <span class="op">=</span> <span class="st">'scientificName'</span>, threshold<span class="op">=</span><span class="fl">0.9</span>, verbose<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">""" Matches an 'unknown_name' against accepted names in a 'name_df'. Will return names that are above a 'threshold' of closeness. </span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameters</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">  ----------</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">  unknown_name: str</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Name we want to match against accepted names. </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">  name_df: DataFrame</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">    DataFrame containing accepted names.</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">  name_col: str, name of name_df column </span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">    DataFrame column containing accepted names.</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">  threshold: int</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">    How closely does the unknown_name need to match with the accepted name.</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">    If above this threshold, the name is added to a dictionary of possible names.</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">  verbose: bool</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Should the function print the entire list of possible names. </span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns:</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="co">  ----------</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co">  str</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co">    Closest name to 'unknown_name' that was above the given 'threshold'.</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="im">import</span> operator</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="im">from</span> difflib <span class="im">import</span> SequenceMatcher</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> similar(a, b):</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> SequenceMatcher(<span class="va">None</span>, a, b).ratio()</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  poss_names <span class="op">=</span> {}</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Only look through entries with the same first letter to save time</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> true_sciname <span class="kw">in</span> name_df[name_df[name_col].<span class="bu">str</span>.startswith(unknown_name[<span class="dv">0</span>])][name_col].values:</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    similar_score <span class="op">=</span> similar(unknown_name, true_sciname)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> similar_score<span class="op">&gt;</span>threshold:</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>      poss_names[true_sciname]<span class="op">=</span>similar_score</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the dict is empty</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> verbose <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(poss_names)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(poss_names):</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'No names close enough to </span><span class="sc">{</span>unknown_name<span class="sc">}</span><span class="ss">.'</span>)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>unknown_name<span class="sc">}</span><span class="ss"> is closest to </span><span class="sc">{</span><span class="bu">max</span>(poss_names.items(), key<span class="op">=</span>operator.itemgetter(<span class="dv">1</span>))[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">, with a score of </span><span class="sc">{</span><span class="bu">max</span>(poss_names.items(), key<span class="op">=</span>operator.itemgetter(<span class="dv">1</span>))[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(poss_names.items(), key<span class="op">=</span>operator.itemgetter(<span class="dv">1</span>))[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fix_name(unknown_name, true_name):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">""" Fixes the aspca_df entries according to the accepted wfo_df entry.</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameters</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">  ----------</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">  unknown_name: str</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Name we want to fix. </span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">  true_name: DataFrame</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Accepted name to use.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the series we're looking to change</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  unknown_data <span class="op">=</span> aspca_df[aspca_df[<span class="st">'Scientific Name'</span>] <span class="op">==</span> unknown_name]</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab accepted data from wfo database based on ID lookup</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  true_data <span class="op">=</span> wfo_df[wfo_df[<span class="st">'scientificName'</span>] <span class="op">==</span> true_name]</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  true_sciname <span class="op">=</span> true_data.loc[:,<span class="st">'scientificName'</span>].values[<span class="dv">0</span>]</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  true_family <span class="op">=</span> true_data.loc[:,<span class="st">'family'</span>].values[<span class="dv">0</span>]</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  true_genus <span class="op">=</span> true_data.loc[:,<span class="st">'genus'</span>].values[<span class="dv">0</span>]</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  true_taxonomicStatus <span class="op">=</span> true_data.loc[:,<span class="st">'taxonomicStatus'</span>].values[<span class="dv">0</span>]</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change scientific name, family, genus and taxonomic status to accepted versions</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  aspca_df.iloc[unknown_data.index,<span class="dv">2</span>] <span class="op">=</span> true_sciname</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  aspca_df.iloc[unknown_data.index,<span class="dv">8</span>] <span class="op">=</span> true_family</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  aspca_df.iloc[unknown_data.index,<span class="dv">9</span>] <span class="op">=</span> true_genus</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  aspca_df.iloc[unknown_data.index,<span class="dv">10</span>] <span class="op">=</span> true_taxonomicStatus</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>unknown_idx <span class="op">=</span> aspca_df[aspca_df.taxonomicStatus <span class="op">==</span> <span class="st">'Unknown'</span>].index</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span><span class="bu">len</span>(unknown_idx)<span class="sc">}</span><span class="ss"> plants currently cannot be matched.'</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm.notebook <span class="im">import</span> tqdm</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(unknown_idx):</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  unknown_name <span class="op">=</span> aspca_df.iloc[i,<span class="dv">2</span>]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  closest_name <span class="op">=</span> get_closest_name(unknown_name)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> closest_name <span class="op">==</span> <span class="st">''</span>:</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">continue</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  fix_name(unknown_name,closest_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>101 plants currently cannot be matched.
Malus sylvestrus is closest to Malus sylvestris, with a score of 0.94
No names close enough to Maranta insignis.
No names close enough to Miltonia roezlii alba.
No names close enough to Neoregalia.
No names close enough to Nephrolepis exalta bostoniensis.
Nephrolepsis exalta is closest to Nephrolepis exaltata, with a score of 0.92
No names close enough to Nephrolepsis cordifolia duffii.
No names close enough to Lilium orientalis.
No names close enough to Nephrolepsis cordifolia plumosa.
Nephrolepis exalta is closest to Nephrolepis exaltata, with a score of 0.95
No names close enough to Lilium asiatica.
Hosta plataginea is closest to Hosta plantaginea, with a score of 0.97
No names close enough to Lampranthus piquet.
Kalmia poliifolia is closest to Kalmia polifolia, with a score of 0.97
Kalmia augustifolia is closest to Kalmia angustifolia, with a score of 0.95
Jasminium is closest to Jasminum, with a score of 0.94
Hoya publcalyx is closest to Hoya pubicalyx, with a score of 0.93
No names close enough to Hoya carnosa krinkle kurl.
No names close enough to Hemigraphis exotica.
Gynura aurantica is closest to Gynura aurantiaca, with a score of 0.97
No names close enough to Nolina tuberculata.
Guzmania lingulata minor is closest to Guzmania lingulata var. minor, with a score of 0.91
Lavendula angustifolia is closest to Lavandula angustifolia, with a score of 0.95
Onychium japonica is closest to Onychium japonicum, with a score of 0.91
No names close enough to Schefflera or brassia actinoplylla.
Paeonis officinalis is closest to Paeonia officinalis, with a score of 0.95
No names close enough to Giant dracaena.
Taxus canadensus is closest to Taxus canadensis, with a score of 0.94
Stapelia hirsata is closest to Stapelia hirsuta, with a score of 0.94
Sorghum vulgare var sudanesis is closest to Sorghum vulgare var. sudanense, with a score of 0.92
Smilax walteria is closest to Smilax walteri, with a score of 0.97
Secum weinbergii is closest to Sedum weinbergii, with a score of 0.94
No names close enough to Scindapsusphilodendron.
Santpaulia confusa is closest to Saintpaulia confusa, with a score of 0.97
Rhipsalis cassutha is closest to Rhipsalis cassytha, with a score of 0.94
Rheum rhabarbarium is closest to Rheum rhabarbarum, with a score of 0.97
Origanum vulgare hirtum is closest to Origanum vulgare var. hirtum, with a score of 0.90
Tolmeia menziesii is closest to Tolmiea menziesii, with a score of 0.94
Podocarpus macrophylla is closest to Podocarpus macrophyllus, with a score of 0.93
Ploystichum munitum is closest to Polystichum munitum, with a score of 0.95
Plectranthus oetendahlii is closest to Plectranthus oertendahlii, with a score of 0.98
Plantanus occidentalis is closest to Platanus occidentalis, with a score of 0.98
Pilea cadieri is closest to Pilea cadierei, with a score of 0.96
No names close enough to Phoenix robellinii.
No names close enough to Peperomia serpens variegata.
Peperomia prostata is closest to Peperomia prostrata, with a score of 0.97
Peperomia griseoargentea is closest to Peperomia griseoargentia, with a score of 0.96
Pellonia pulchra is closest to Pellionia pulchra, with a score of 0.97
Rhapis flabelliformus is closest to Rhapis flabelliformis, with a score of 0.95
Fuschsia is closest to Fuchsia, with a score of 0.93
No names close enough to Begonia rex peace.
Eriogonium umbellatum is closest to Eriogonum umbellatum, with a score of 0.98
Citrus aurantifolia is closest to Citrus aurantiifolia, with a score of 0.97
Cissus dicolor is closest to Cissus discolor, with a score of 0.97
Chlorophytum bichetti is closest to Chlorophytum bichetii, with a score of 0.95
No names close enough to Ceratostigma larpentiae.
Cattleya trianaei is closest to Cattleya trianae, with a score of 0.97
Camellia japonica thea japonica is closest to Camellia japonica var. japonica, with a score of 0.90
Caesalpinia gilliessi is closest to Caesalpinia gilliesii, with a score of 0.95
Borage officinalis is closest to Borago officinalis, with a score of 0.94
No names close enough to Bertolonia mosaica.
No names close enough to Begonia semperflorens cultivar.
Begonia scharfii is closest to Begonia scharffii, with a score of 0.97
Begonia cleopatra is closest to Begonia cleopatrae, with a score of 0.97
No names close enough to Asparagus densiflorus sprengeri.
Arum palestinum is closest to Arum palaestinum, with a score of 0.97
Anthurium scherzeranum is closest to Anthurium scherzerianum, with a score of 0.98
Anthirrhinum multiflorum is closest to Antirrhinum multiflorum, with a score of 0.98
Anoectuchilus setaceus is closest to Anoectochilus setaceus, with a score of 0.95
Anethum graveolena is closest to Anethum graveolens, with a score of 0.94
No names close enough to Albiflora.
No names close enough to Acantha.
Tradescantia flumeninsis is closest to Tradescantia fluminensis, with a score of 0.92
Citrus aurantium is closest to Citrus Ã—aurantium, with a score of 0.97
Euonymus atropurpurea is closest to Euonymus atropurpureus, with a score of 0.93
Citrus limonia is closest to Citrus Ã—limonia, with a score of 0.97
Cleome hasserlana is closest to Cleome hassleriana, with a score of 0.91
Eriogonium inflatum is closest to Eriogonum inflatum, with a score of 0.97
No names close enough to Episcia cultivar.
Epidendrum atropurpeum is closest to Epidendrum atropurpureum, with a score of 0.96
Eleagnus is closest to Elaeagnus, with a score of 0.94
No names close enough to Echeveria puloliver.
Echeveria pulinata is closest to Echeveria pulvinata, with a score of 0.97
No names close enough to Echevaria.
No names close enough to Dypsis lutescens chrysalidocarpus lutescens alternate scientific name.
No names close enough to Draceana.
No names close enough to Daucus carota sativa.
Citrus paradisii is closest to Citrus paradisi, with a score of 0.97
No names close enough to Cycasrevolutazamia.
No names close enough to Cucurbita maxima turbaniformis.
No names close enough to Cucurbita maxima hubbard.
No names close enough to Cucurbita maxima butternut.
No names close enough to Cucurbita maxima buttercup.
No names close enough to Cucurbita maxima banana.
No names close enough to Cucurbia pepo zucchini.
No names close enough to Cryptanthus bivattus minor.
Coleus ampoinicus is closest to Coleus amboinicus, with a score of 0.94
Clivia minata is closest to Clivia miniata, with a score of 0.96
Clintonia umbelluata is closest to Clintonia umbellulata, with a score of 0.98
No names close enough to Cycasandzamia.
Veitchia merillii is closest to Veitchia merrillii, with a score of 0.97
</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"36d669c2d6814ff886814ca33073bc08","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scientific names that don't match anything on record automatically</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>unknown_df <span class="op">=</span> aspca_df[aspca_df.taxonomicStatus <span class="op">==</span> <span class="st">'Unknown'</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Synonyms that don't have a database link to the accepted name</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.sort_values(<span class="st">'taxonomicStatus'</span>).drop_duplicates(<span class="st">'Scientific Name'</span>, keep<span class="op">=</span><span class="st">'first'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>unknown_ids <span class="op">=</span> aspca_df[(aspca_df.acceptedNameUsageID <span class="op">==</span> <span class="st">'Unknown'</span>) <span class="op">&amp;</span> (aspca_df.taxonomicStatus <span class="op">==</span> <span class="st">'Synonym'</span>)]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(unknown_ids) <span class="op">+</span> <span class="bu">len</span>(unknown_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>52</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually fix some scientific names that don't match anything on record automatically</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Nephrolepsis cordifolia plumosa'</span>, <span class="st">'Nephrolepis cordifolia'</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Nephrolepsis cordifolia duffii'</span>, <span class="st">'Nephrolepis cordifolia'</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Nephrolepis exalta bostoniensis'</span>, <span class="st">'Nephrolepis exaltata'</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Neoregalia'</span>, <span class="st">'Neoregelia'</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Miltonia roezlii alba'</span>, <span class="st">'Miltonia roezlii'</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Maranta insignis'</span>, <span class="st">'Calathea insignis'</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Lilium orientalis'</span>, <span class="st">'Lilium japonicum'</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Lampranthus piquet'</span>, <span class="st">'Lampranthus piquetbergensis'</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Hoya carnosa krinkle kurl'</span>, <span class="st">'Hoya carnosa'</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Hemigraphis exotica'</span>, <span class="st">'Hemigraphis alternata'</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Lilium asiatica'</span>, <span class="st">'Lilium japonicum'</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Nolina tuberculata'</span>, <span class="st">'Beaucarnea recurvata'</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Giant dracaena'</span>, <span class="st">'Cordyline australis'</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Scindapsusphilodendron'</span>, <span class="st">'Philodendron scandens'</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Schefflera or brassia actinoplylla'</span>, <span class="st">'Schefflera actinophylla'</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Phoenix robellinii'</span>, <span class="st">'Phoenix roebelenii'</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Peperomia serpens variegata'</span>, <span class="st">'Peperomia serpens'</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Bertolonia mosaica'</span>, <span class="st">'Fittonia albivenis'</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Begonia semperflorens cultivar'</span>, <span class="st">'Begonia semperflorens'</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Begonia rex peace'</span>, <span class="st">'Begonia rex'</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Asparagus densiflorus sprengeri'</span>, <span class="st">'Asparagus densiflorus'</span>)</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Albiflora'</span>, <span class="st">'Tradescantia zebrina'</span>)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Acantha'</span>, <span class="st">'Acanthus'</span>)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Episcia cultivar'</span>, <span class="st">'Episcia'</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Echevaria'</span>, <span class="st">'Echeveria'</span>)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Echeveria puloliver'</span>, <span class="st">'Echeveria harmsii'</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Dypsis lutescens chrysalidocarpus lutescens alternate scientific name'</span>, <span class="st">'Dypsis lutescens'</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Draceana'</span>, <span class="st">'Dracaena'</span>)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Daucus carota sativa'</span>, <span class="st">'Daucus carota'</span>)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Ceratostigma larpentiae'</span>, <span class="st">'Ceratostigma plumbaginoides'</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cycasrevolutazamia'</span>, <span class="st">'Cycas revoluta'</span>)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cucurbita maxima turbaniformis'</span>, <span class="st">'Cucurbita maxima'</span>)</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cucurbita maxima hubbard'</span>, <span class="st">'Cucurbita maxima'</span>)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cucurbita maxima butternut'</span>, <span class="st">'Cucurbita maxima'</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cucurbita maxima banana'</span>, <span class="st">'Cucurbita maxima'</span>)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cucurbita maxima buttercup'</span>, <span class="st">'Cucurbita maxima'</span>)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cucurbia pepo zucchini'</span>, <span class="st">'Cucurbita pepo'</span>)</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cryptanthus bivattus minor'</span>, <span class="st">'Cryptanthus bivittatus'</span>)</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cycasandzamia'</span>, <span class="st">'Cycas'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually match up synonyms that don't have a database link to the accepted name</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Chlorophytum bichetii'</span>, <span class="st">'Chlorophytum laxum'</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Rhapis flabelliformis'</span>, <span class="st">'Rhapis excelsa'</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cleome hassleriana'</span>, <span class="st">'Cleome spinosa'</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Pellionia pulchra'</span>, <span class="st">'Pellionia repens'</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cissus discolor'</span>, <span class="st">'Cissus javana'</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Miltonia roezlii'</span>, <span class="st">'Miltoniopsis roezlii'</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Sorghum vulgare var. sudanense'</span>, <span class="st">'Sorghum bicolor'</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Camellia japonica var. japonica'</span>, <span class="st">'Camellia japonica'</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Onychium japonicum'</span>, <span class="st">'Onychium japonicum'</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Epidendrum atropurpureum'</span>, <span class="st">'Psychilis atropurpurea'</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Philodendron scandens'</span>, <span class="st">'Philodendron hederaceum'</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Origanum vulgare var. hirtum'</span>, <span class="st">'Origanum vulgare subsp. hirtum'</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Guzmania lingulata var. minor'</span>, <span class="st">'Guzmania lingulata var. concolor'</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Lavandula angustifolia'</span>, <span class="st">'Lavandula angustifolia'</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Begonia semperflorens'</span>, <span class="st">'Begonia cucullata'</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Calathea insignis'</span>, <span class="st">'Calathea crotalifera'</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Citrus Ã—limonia'</span>, <span class="st">'Citrus limon'</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Coleus amboinicus'</span>, <span class="st">'Plectranthus amboinicus'</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Rhipsalis cassytha'</span>, <span class="st">'Rhipsalis dichotoma'</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Lycopersicon'</span>, <span class="st">'Solanum lycopersicum'</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Lachenalia lilacina'</span>, <span class="st">'Iris domestica'</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>fix_name(<span class="st">'Cymopterus watsonii'</span>, <span class="st">'Cymopterus terebinthinus'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scientific names that don't match anything on record automatically</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>unknown_df <span class="op">=</span> aspca_df[aspca_df.taxonomicStatus <span class="op">==</span> <span class="st">'Unknown'</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Synonyms that don't have a database link to the accepted name</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.sort_values(<span class="st">'taxonomicStatus'</span>).drop_duplicates(<span class="st">'Scientific Name'</span>, keep<span class="op">=</span><span class="st">'first'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>unknown_ids <span class="op">=</span> aspca_df[(aspca_df.acceptedNameUsageID <span class="op">==</span> <span class="st">'Unknown'</span>) <span class="op">&amp;</span> (aspca_df.taxonomicStatus <span class="op">==</span> <span class="st">'Synonym'</span>)]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(unknown_ids) <span class="op">+</span> <span class="bu">len</span>(unknown_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>synonym_idx <span class="op">=</span> aspca_df[aspca_df[<span class="st">'taxonomicStatus'</span>].values <span class="op">==</span> <span class="st">'Synonym'</span>].index</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span><span class="bu">len</span>(synonym_idx)<span class="sc">}</span><span class="ss"> entries have a more acceptable synonym'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>71 entries have a more acceptable synonym</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Work to update the remaining scientific names that are synonyms for their accepted scientific names</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.sort_values(<span class="st">'taxonomicStatus'</span>).drop_duplicates(<span class="st">'Scientific Name'</span>, keep<span class="op">=</span><span class="st">'first'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>synonym_idx <span class="op">=</span> aspca_df[aspca_df[<span class="st">'taxonomicStatus'</span>].values <span class="op">==</span> <span class="st">'Synonym'</span>].index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> synonym_idx:</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the series we're looking to change</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  synonym_data <span class="op">=</span> aspca_df.iloc[i,:]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  synonym_name <span class="op">=</span> synonym_data.loc[<span class="st">'Scientific Name'</span>]</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab accepted data from wfo database based on ID lookup</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  true_data <span class="op">=</span> wfo_df[wfo_df[<span class="st">'taxonID'</span>] <span class="op">==</span> synonym_data.loc[<span class="st">'acceptedNameUsageID'</span>]]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  true_sciname <span class="op">=</span> true_data.iloc[:,<span class="dv">1</span>].values[<span class="dv">0</span>]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  fix_name(synonym_name,true_sciname)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>IndexError: index 0 is out of bounds for axis 0 with size 0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>synonym_idx <span class="op">=</span> aspca_df[aspca_df[<span class="st">'taxonomicStatus'</span>].values <span class="op">==</span> <span class="st">'Synonym'</span>].index</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span><span class="bu">len</span>(synonym_idx)<span class="sc">}</span><span class="ss"> entries have a more acceptable synonym'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>31 entries have a more acceptable synonym</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort and drop again</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.sort_values(<span class="st">'taxonomicStatus'</span>).drop_duplicates(<span class="st">'Scientific Name'</span>, keep<span class="op">=</span><span class="st">'first'</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.sort_values(<span class="st">'Scientific Name'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>).sort_index()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set genus of one-word names to be the name, rather than NaN</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>aspca_df.loc[aspca_df.fillna(<span class="st">'Unknown'</span>)[<span class="st">'genus'</span>]<span class="op">==</span><span class="st">'Unknown'</span>, <span class="st">'genus'</span>] <span class="op">=</span> aspca_df.loc[aspca_df.fillna(<span class="st">'Unknown'</span>)[<span class="st">'genus'</span>]<span class="op">==</span><span class="st">'Unknown'</span>, <span class="st">'Scientific Name'</span>]</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop columns we no longer need</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df.drop([<span class="st">'taxonID'</span>, <span class="st">'scientificName'</span>, <span class="st">'taxonomicStatus'</span>, <span class="st">'acceptedNameUsageID'</span>, <span class="st">'taxonRank'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize column names</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>aspca_df.rename(columns <span class="op">=</span> {<span class="st">'genus'</span>:<span class="st">'Genus'</span>, <span class="st">'family'</span>:<span class="st">'Family'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">'Name'</span>, <span class="st">'Scientific Name'</span>, <span class="st">'Genus'</span>, <span class="st">'Family'</span>, <span class="st">'Alternative Names'</span>, <span class="st">'Toxic to Dogs'</span>, <span class="st">'Toxic to Cats'</span>]</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>aspca_df <span class="op">=</span> aspca_df[cols]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>aspca_df.to_csv(<span class="st">'Plant Toxicity - v6.csv'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>aspca_df.sample(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Scientific Name</th>
<th data-quarto-table-cell-role="th">Genus</th>
<th data-quarto-table-cell-role="th">Family</th>
<th data-quarto-table-cell-role="th">Alternative Names</th>
<th data-quarto-table-cell-role="th">Toxic to Dogs</th>
<th data-quarto-table-cell-role="th">Toxic to Cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">102</td>
<td>Celosia Globosa</td>
<td>Celosia globosa</td>
<td>Celosia</td>
<td>Amaranthaceae</td>
<td>Globe Amarantha, Perpetua</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>Alocasia</td>
<td>Alocasia</td>
<td>Alocasia</td>
<td>Araceae</td>
<td>Elephant's Ear</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">386</td>
<td>Variegated Philodendron</td>
<td>Philodendron hederaceum</td>
<td>Philodendron</td>
<td>Araceae</td>
<td></td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">411</td>
<td>American Mandrake</td>
<td>Podophyllum peltatum</td>
<td>Podophyllum</td>
<td>Berberidaceae</td>
<td>Mayapple, Indian Apple Root, Umbrella Leaf, Wi...</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">94</td>
<td>Chestnut</td>
<td>Castanea dentata</td>
<td>Castanea</td>
<td>Fagaceae</td>
<td>American Chestnut</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">291</td>
<td>Butterfly Iris</td>
<td>Iris spuria</td>
<td>Iris</td>
<td>Iridaceae</td>
<td>Spuria Iris</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">243</td>
<td>Climbing Lily</td>
<td>Gloriosa superba</td>
<td>Gloriosa</td>
<td>Colchicaceae</td>
<td>Gloriosa Lily, Glory Lily, Superb Lily</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Measles Plant</td>
<td>Acanthus</td>
<td>Acanthus</td>
<td>Acanthaceae</td>
<td>Polka Dot Plant, Flamingo Plant, Babyâ€™s Tears,...</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">246</td>
<td>Orange Star</td>
<td>Guzmania lingulata var. concolor</td>
<td>Guzmania</td>
<td>Bromeliaceae</td>
<td></td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">420</td>
<td>Algaroba</td>
<td>Prosopis limensis</td>
<td>Prosopis</td>
<td>Fabaceae</td>
<td>Kiawe, Mesquite</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>aspca_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Scientific Name</th>
<th data-quarto-table-cell-role="th">Genus</th>
<th data-quarto-table-cell-role="th">Family</th>
<th data-quarto-table-cell-role="th">Alternative Names</th>
<th data-quarto-table-cell-role="th">Toxic to Dogs</th>
<th data-quarto-table-cell-role="th">Toxic to Cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Sand Verbena</td>
<td>Abronia fragrans</td>
<td>Abronia</td>
<td>Nyctaginaceae</td>
<td>Prairie Snowball, Wild Lantana</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Prayer Bean</td>
<td>Abrus precatorius</td>
<td>Abrus</td>
<td>Fabaceae</td>
<td>Rosary Pea, Buddhist Rosary Bead, Indian Bead,...</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Copperleaf</td>
<td>Acalypha godseffiana</td>
<td>Acalypha</td>
<td>Euphorbiaceae</td>
<td>Lance Copperleaf</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Chenille Plant</td>
<td>Acalypha hispida</td>
<td>Acalypha</td>
<td>Euphorbiaceae</td>
<td>Philippine Medusa, Foxtail, Red-hot Cat Tail</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Measles Plant</td>
<td>Acanthus</td>
<td>Acanthus</td>
<td>Acanthaceae</td>
<td>Polka Dot Plant, Flamingo Plant, Babyâ€™s Tears,...</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>aspca_df[aspca_df[<span class="st">'Toxic to Dogs'</span>] <span class="op">!=</span> aspca_df[<span class="st">'Toxic to Cats'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Scientific Name</th>
<th data-quarto-table-cell-role="th">Genus</th>
<th data-quarto-table-cell-role="th">Family</th>
<th data-quarto-table-cell-role="th">Alternative Names</th>
<th data-quarto-table-cell-role="th">Toxic to Dogs</th>
<th data-quarto-table-cell-role="th">Toxic to Cats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">262</td>
<td>Day Lilies (many varieties)</td>
<td>Hemerocallis</td>
<td>Hemerocallis</td>
<td>Xanthorrhoeaceae</td>
<td></td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">263</td>
<td>Orange Day Lily</td>
<td>Hemerocallis graminea</td>
<td>Hemerocallis</td>
<td>Xanthorrhoeaceae</td>
<td></td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">296</td>
<td>Black Walnut</td>
<td>Juglans nigra</td>
<td>Juglans</td>
<td>Juglandaceae</td>
<td></td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">317</td>
<td>Lily</td>
<td>Lilium</td>
<td>Lilium</td>
<td>Liliaceae</td>
<td></td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">319</td>
<td>Tiger Lily</td>
<td>Lilium lancifolium</td>
<td>Lilium</td>
<td>Liliaceae</td>
<td></td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">320</td>
<td>Easter Lily</td>
<td>Lilium longiflorum</td>
<td>Lilium</td>
<td>Liliaceae</td>
<td></td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">321</td>
<td>Red Lily</td>
<td>Lilium philadelphicum</td>
<td>Lilium</td>
<td>Liliaceae</td>
<td></td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">322</td>
<td>Japanese Show Lily</td>
<td>Lilium speciosum</td>
<td>Lilium</td>
<td>Liliaceae</td>
<td></td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>aspca_df[[<span class="st">'Family'</span>,<span class="st">'Toxic to Dogs'</span>,<span class="st">'Toxic to Cats'</span>]].pivot_table(index <span class="op">=</span> <span class="st">'Family'</span>).sort_values(by<span class="op">=</span><span class="st">'Toxic to Dogs'</span>)[<span class="dv">70</span>:<span class="dv">80</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Toxic to Cats</th>
<th data-quarto-table-cell-role="th">Toxic to Dogs</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Family</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Lauraceae</td>
<td>0.500000</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Proteaceae</td>
<td>0.500000</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Convolvulaceae</td>
<td>0.500000</td>
<td>0.500000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Commelinaceae</td>
<td>0.500000</td>
<td>0.500000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Euphorbiaceae</td>
<td>0.600000</td>
<td>0.600000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Fabaceae</td>
<td>0.600000</td>
<td>0.600000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Berberidaceae</td>
<td>0.666667</td>
<td>0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Polygonaceae</td>
<td>0.666667</td>
<td>0.666667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Apiaceae</td>
<td>0.666667</td>
<td>0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Moraceae</td>
<td>0.666667</td>
<td>0.666667</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many Families have mixed toxicity</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(aspca_df[[<span class="st">'Family'</span>,<span class="st">'Toxic to Dogs'</span>,<span class="st">'Toxic to Cats'</span>]].pivot_table(index <span class="op">=</span> <span class="st">'Family'</span>).sort_values(by<span class="op">=</span><span class="st">'Toxic to Dogs'</span>)[aspca_df[[<span class="st">'Family'</span>,<span class="st">'Toxic to Dogs'</span>,<span class="st">'Toxic to Cats'</span>]].pivot_table(index <span class="op">=</span> <span class="st">'Family'</span>).sort_values(by<span class="op">=</span><span class="st">'Toxic to Dogs'</span>)[<span class="st">'Toxic to Dogs'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">0</span><span class="op">&lt;</span>x<span class="op">&lt;</span><span class="dv">1</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>33</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many Families</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(aspca_df[<span class="st">'Family'</span>].unique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>111</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>aspca_df[[<span class="st">'Genus'</span>,<span class="st">'Toxic to Dogs'</span>,<span class="st">'Toxic to Cats'</span>]].pivot_table(index <span class="op">=</span> <span class="st">'Genus'</span>).sort_values(by<span class="op">=</span><span class="st">'Toxic to Dogs'</span>)[<span class="dv">208</span>:<span class="dv">218</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Toxic to Cats</th>
<th data-quarto-table-cell-role="th">Toxic to Dogs</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Genus</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Schefflera</td>
<td>0.666667</td>
<td>0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Cordyline</td>
<td>0.666667</td>
<td>0.666667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Iris</td>
<td>0.666667</td>
<td>0.666667</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Aloe</td>
<td>0.666667</td>
<td>0.666667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dracaena</td>
<td>0.800000</td>
<td>0.800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Aralia</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ficus</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Apocynum</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Sansevieria</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Rumex</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many Genuses have mixed toxicity</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(aspca_df[[<span class="st">'Genus'</span>,<span class="st">'Toxic to Dogs'</span>,<span class="st">'Toxic to Cats'</span>]].pivot_table(index <span class="op">=</span> <span class="st">'Genus'</span>).sort_values(by<span class="op">=</span><span class="st">'Toxic to Dogs'</span>)[aspca_df[[<span class="st">'Genus'</span>,<span class="st">'Toxic to Dogs'</span>,<span class="st">'Toxic to Cats'</span>]].pivot_table(index <span class="op">=</span> <span class="st">'Genus'</span>).sort_values(by<span class="op">=</span><span class="st">'Toxic to Dogs'</span>)[<span class="st">'Toxic to Dogs'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">0</span><span class="op">&lt;</span>x<span class="op">&lt;</span><span class="dv">1</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>9</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many Genuses</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(aspca_df[[<span class="st">'Genus'</span>,<span class="st">'Toxic to Dogs'</span>,<span class="st">'Toxic to Cats'</span>]].pivot_table(index <span class="op">=</span> <span class="st">'Genus'</span>).sort_values(by<span class="op">=</span><span class="st">'Toxic to Dogs'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>346</code></pre>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If running in Colabs</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install selenium <span class="op">-</span>q</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>apt<span class="op">-</span>get update <span class="co"># to update ubuntu to correctly run apt install</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>apt install chromium<span class="op">-</span>chromedriver <span class="op">-</span>q</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cp <span class="op">/</span>usr<span class="op">/</span>lib<span class="op">/</span>chromium<span class="op">-</span>browser<span class="op">/</span>chromedriver <span class="op">/</span>usr<span class="op">/</span><span class="bu">bin</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: You are using pip version 20.2.3; however, version 20.2.4 is available.
You should consider upgrading via the '/home/gao/anaconda3/bin/python -m pip install --upgrade pip' command.
Reading package lists... Done
E: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)
E: Unable to lock directory /var/lib/apt/lists/
W: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)
W: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)
E: Could not open lock file /var/lib/dpkg/lock-frontend - open (13: Permission denied)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), are you root?
cp: cannot stat '/usr/lib/chromium-browser/chromedriver': No such file or directory</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>sys.path.insert(<span class="dv">0</span>,<span class="st">'/usr/lib/chromium-browser/chromedriver'</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Import and setup the Selenium webdriver</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> selenium <span class="im">import</span> webdriver</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>chrome_options <span class="op">=</span> webdriver.ChromeOptions()</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>chrome_options.add_argument(<span class="st">'--headless'</span>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>chrome_options.add_argument(<span class="st">'--no-sandbox'</span>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>chrome_options.add_argument(<span class="st">'--disable-dev-shm-usage'</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>wd <span class="op">=</span> webdriver.Chrome(<span class="st">'chromedriver'</span>,chrome_options<span class="op">=</span>chrome_options)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>